# 📚 歷史資料查詢與製程趨勢圖區塊總覽

---

## 🗓️ 1. 時間區間選擇區塊

### 🔍 功能說明

本區塊提供操作人員查詢指定區間內的歷史製程參數與排放數據，支援精確的起訖時間選擇，用於事故追溯、排放稽核、模型誤差分析與操作策略回顧。

### 🧭 查詢選項：

- 起始時間與結束時間
- 查詢觸發：按下「查詢」按鈕後，系統自動載入對應區段資料並更新圖表與統計

---

## 📉 2. 製程參數趨勢圖展示

### 📌 功能說明

使用者可依需求選擇多項參數並進行趨勢分析，支援疊加或個別模式，視覺化走勢圖結合互動滑動與即時數值追蹤，方便比對跨參數變化關聯。

### 🎛️ 可選參數：

後端 API 提供所有可選欄位

### 📊 顯示模式：

- ✅ **疊加繪圖模式**（預設）：多參數同圖展示
- ✅ **分開顯示模式**：每項參數個別顯示圖表
- 🔧 圖高預設為 50px，可視需求調整

### 🧩 圖表視覺風格（對齊 Dashboard）

- 左上角顯示即時值（粗體數字）
- ▲ / ▼ 三角符號標示變動方向
- 虛線標示基準值（如上限、平均值）
- 顏色區分每個參數（含填色陰影）
- 支援 Tooltip、區間滑動與動態高亮
- 基於 Chart.js 實作，視覺與交互風格一致

---

## 🔄 3. 區間切換與統計摘要功能（趨勢圖下方）

使用者可切換趨勢圖資料區間，用於分析不同時間尺度下的變化趨勢與統計指標。

### 📆 支援的時間區間選擇：

- 📍 **今日（Today）**：每分鐘資料，用於即時異常監控
- 📍 **過去一小時**：高頻短期趨勢，適合即時調整注氨量
- 📍 **本週**：識別製程異常與累積偏差現象
- 📍 **本月**：觀察中期系統穩定性與注氨效能
- 📍 **自訂區間**：選擇任意起訖時間，支援時間滑動視圖

### 📊 區段統計摘要（未來版本支援）

| 指標             | 說明 |
|------------------|------|
| 平均值           | 區段內數據的平均值 |
| 最大值 / 最小值   | 極值點分析，搭配圖表標記 |
| 升降趨勢（%）    | 區段首尾變動比率，顯示 ▲ / ▼ |
| 超標事件計數     | 超過警戒值次數與持續時間 |

---

## 🧱 4. 支援的圖表互動功能（與 Dashboard 同風格）

- 🕒 **時間軸滑動與縮放**：快速縮放與捲動歷史範圍
- 🖱️ **滑鼠懸停提示 Tooltip**：即時顯示數值與時間
- 🔁 **圖層切換**：支援實測、預測、建議等多層切換與疊圖
- 📏 **基準線標示**：如安全值、警戒值、自定義線（虛線）
- 📐 **誤差範圍展示**：如 ±σ 視覺區間
- 📊 **注氨建議 vs 實際對照差異視覺化**

---

## 📤 5. 資料匯出功能區塊

| 功能項目           | 說明                                               |
|--------------------|----------------------------------------------------|
| 匯出 CSV           | 下載查詢區間內的原始資料（表格格式）                |
| 匯出圖表為 PNG     | 將趨勢圖以圖片格式輸出，方便列印或報告整合           |

---

## 📌 備註

- 查詢資料來源：PostgreSQL 歷史資料表
- 資料精度：預設支援分鐘級資料

---
